<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register | Axiora</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="auth-body auth-register">
  <div class="auth-orb orb-a"></div>
  <div class="auth-orb orb-b"></div>

  <main class="auth-shell">
    <section class="auth-brand">
      <div class="brand-badge">
        <img src="../assets/logo/start-icon.png" alt="Axiora icon">
        <span>Axiora</span>
      </div>
      <h1>Create your account</h1>
      <p>Start building deep work habits with Axiora today.</p>
    </section>

    <section class="auth-panel">
      <h2>Get Started</h2>

      <label for="email">Email</label>
      <input type="email" id="email" placeholder="you@example.com" autocomplete="email">

      <label for="password">Password</label>
      <input type="password" id="password" placeholder="Create a password" autocomplete="new-password">

      <button class="auth-btn" id="registerBtn">Create Account</button>
      <p class="auth-switch">Already have an account? <a href="login.html">Login</a></p>
      <p class="inline-error" id="authError"></p>
    </section>
  </main>

  <script src="apiService.js"></script>
  <script src="authService.js"></script>
  <script>
    const errorBox = document.getElementById("authError");
    const registerBtn = document.getElementById("registerBtn");

    function showError(message) {
      errorBox.textContent = message;
      errorBox.style.display = "block";
    }

    function clearError() {
      errorBox.textContent = "";
      errorBox.style.display = "none";
    }

    document.addEventListener("DOMContentLoaded", () => {
      window.authService.autoLogin();
    });

    registerBtn.addEventListener("click", async () => {
      clearError();
      const email = document.getElementById("email").value.trim().toLowerCase();
      const password = document.getElementById("password").value;

      if (!email || !password) {
        showError("Email and password are required.");
        return;
      }

      const result = await window.authService.registerUser(email, password);
      if (!result || !result.ok) {
        showError(result && result.message ? result.message : "Registration failed.");
        return;
      }

      window.location.href = "login.html";
    });
  </script>
</body>
</html>
